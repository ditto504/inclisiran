## 背景

Inclisiran以及ORION 18是正在开展的一项RCT研究。

作为整个研究PI所在的中心，北京大学第一医院也正在参与其中。而入选患者的筛选工作，就由我来负责。基于研究的入选和排除标准，我首先想到，能否利用电子病历（EHR）数据来更便捷、高效的进行患者的筛选和入组。

于是也有了这个Github项目。

## 说明

### 数据

#### 去隐私处理

本项目提供的9位患者的示例数据，虽然来源于真实EMR及我院心血管临床数据仓库，但为保护真实患者的隐私，已经对所有涉及个人隐私信息的数据进行了加密处理。

尤其涉及到具体时间信息的数据，针对每个患者的所有数据库里涉及时间的变量，都进行了一个唯一随机数的时间漂移变量。这样做的好处，虽然我们无法根据某一次时间来定位该患者，但涉及到**年龄**这样的信息，我们依然可以利用**出生日期**与**当前时间**的时间差，来得到真实的年龄信息。这对于后续的数据分析是很有价值的。因此，可能会看到诸如`3303-02-21 08:40:50`这样的时间数据。

#### 数据表简介

这个项目中所有的示例数据，都包含在`/data`文件夹里。这个文件夹包含四个数据表，即dataframe，具体内容及包含变量如下：

##### empi.csv

即患者唯一识别码数据表，`empi`是住院或门诊等所有系统中该患者的唯一识别码。而其中`pid`是患者住院电子病历数据的唯一标识。`name`是患者姓名，`sex`是性别，`birthday`是患者的出生日期。

**注意**：针对每个患者的所有数据库里涉及时间的变量，都进行了一个唯一随机数的时间漂移变量。这样做的好处，虽然我们无法根据某一次时间来定位该患者，但涉及到**年龄**这样的信息，我们依然可以利用**出生日期**与**当前时间**的时间差，来得到真实的年龄信息。这对于后续的数据分析是很有价值的。

##### in_patient.csv

即患者住院信息表。其中`pflow`是此次入院的唯一标识，同一个患者，只会有唯一的`pid`与`empi`，但如果有多次住院，则会对应不同的`pflow`。

`in_datetime`与`out_datetime`分别是入院和出院的时间，如上文所述，也进行了随机数的漂移处理。`dept`是患者所在科室信息。

##### lis_sample.csv

即患者检验项目表，包含住院和门诊检验信息，该表中的数据是一份样本（如血常规、生化）的信息，具体的详细结果信息，请见`lis_result.csv`。

其中，`sid`是该样本的id，也是利用这一id与`lis_result.csv`中的结果相关联。`sampling_time`是该标本采样的时间，之所以选择采样时间，是考虑到采样时间才是真实的“抽血”时间，代表了患者当时的情况。**因为临床中的确会遇到，抽血之后放置一段时间才会上机检测，所以并没有使用上机检测，或是审核时间。**

另外，这里的`sampling_time`也做了基于患者的随机时间漂移处理。

##### lis_result.csv

即患者检验具体结果表，包含了所有住院和门诊的检验信息。利用`sid`与`lis_sample.csv`相关联。

其中`ENGLISH_NAME`与`CHINESE_NAME`是结果项目的英文与中文名称。`QUANTITATIVE_RESULT`是定量结果，`QUALITATIVE_RESULT`是定性结果，`TEST_ITEM_REFERENCE`是参考区间，`TEST_ITEM_UNIT`是单位。

##### meds.csv

最后是药品数据表。因为**Inclisiran**所需要的信息，此处仅提供了**住院中的出院带药**信息。

之所以没有提供门诊的处方数据，因为真实的EHR数据库中存储的剂量信息，往往**并非**患者真实的服药信息。例如门诊经常为了规避医保政策，采用加倍单次剂量的方式，给患者开更长时间的长期药品。例如，原本`阿托伐他汀20mg QN`的医嘱，如果门诊往往会开成`阿托伐他汀40mg QN`，这样医保限制只能开2周的药，就够患者吃1个月了。这个信息医生、患者都清楚患者吃的是20mg的剂量，但这个数据记录在EHR数据库里，就会给实际的患者筛选带来错误。

其中，`ADVICE_CONTENT`是药品名称，其中包含了商品名和（或）化学名。`SPEC`是包装信息。`DOSAGE`是单次服药剂量。`DOSAGE_UNIT`是剂量单位。`med_time`是医嘱下达日期，也做了基于患者的随机时间漂移处理。

考虑到不增加太多数据清洗与处理的过程，所以此处提前对药品信息进行了清洗与处理，所以此处没有涉及更复杂的**长期短期医嘱**、**医嘱频率**、**医嘱状态**、**剂量换算**等实际上在处理EHR数据时经常会遇到的问题。

### 患者筛选过程

所有的筛选过程，可以在[`inclisiran_patient_filter.md`](../inclisiran_patient_filter.md)中查看。里面也包含详细的考虑和过程。

原始的R notebook文档，都记录在[`inclisiran_patient_filter.Rmd`](../inclisiran_patient_filter.Rmd)。

通常，我们会利用**Rnotebook**或是**Jupyter Notebook**这一类**文学式编程**的工具，将我们解决问题的思路、代码以及输出的结果可以统一在一个界面展示。这样做的好处，可以极大提高临床医生与数据科学家之间沟通的效率，而且任何动态的修改过程也都可以一目了然。

## 希望达到的目的

北京大学第一医院心内科已经开展了相当多基于EHR与心血管专科数据和信息化的研究项目，但由于种种限制，国内在这一领域开展的并不多。

个人总结，一方面的困难来自于“非技术因素”，如医院基于安全等考量拒绝给临床科室或临床研究项目提供批量导出的EHR数据；但更多的可能来源于理念上的缺乏，许多PI仍希望研究生、CRC去对着电子病历系统“录入”数据，殊不知实际上很大比例的电子病历数据已经是相当好的“结构化”数据，如果直接拿来，可以起到事半功倍的效果。

另一层面，EHR数据的二次应用，本身就是一门“科学”。这既不同于以往的医学统计学，又与IT工程师所从事的纯“代码”工作有着巨大差异。这其中，需要了解临床实践流程，才能明白这些数据产生的背景以及具体的临床意义；还需要具备数据库的知识，起码是关系型数据库的知识，才能进行多个数据表之间的连接和查询；更需要掌握基本的统计、数据处理能力，否则面对大量的、不同于传统excel表里存储的CRF式的“大横表”数据，注定会无所适从。除此之外，更不要说诸如**数据缺失**、**异常值**，乃至刚才上文提到的**门诊医嘱剂量数据**等“坑”了。

所以，借着此次inclisiran和ORION 18研究项目的契机，希望多多与国内各中心交流相关的经验。如果能够因此，加速整个研究进程，帮助到更多医院入选更多适合的患者，也是很有意义的事。

欢迎各位同道和专家指正，如果有任何问题，也欢迎在github提出，或是写邮件给我。

2021.03.19